{% extends "base/base.html" %}
{% load widget_tweaks %}

{% block head %}
<style>
.hero-wrap{
    background:
        linear-gradient(
            to right,
            rgba(0,0,0,0.75),
            rgba(0,0,0,0.55),
            rgba(0,0,0,0.2)
        ),
        {% if need.image %}
            url('{{ need.image.url }}')
        {% endif %};
    background-size: cover;
    background-position: center;
    border-radius: 18px;
    padding: 40px;
    color: #fff;
}

.hero-poster{
    width: 100%;
    max-width: 260px;
    border-radius: 14px;
    box-shadow: 0 12px 30px rgba(0,0,0,.35);
    background: #fff;
}

.hero-points p{
    margin-bottom: 6px;
    font-size: 15px;
}

.status-badge{
    background: #facc15;
    color: #000;
    font-weight: 600;
    padding: 6px 14px;
    border-radius: 20px;
}

.desc-box{
    background: #fff;
    border-radius: 16px;
    padding: 32px;
    box-shadow: 0 8px 26px rgba(0,0,0,.08);
}
</style>
{% endblock head %}


{% block body %}
<section class="container my-5">

    <!-- HERO SECTION -->
    <div class="hero-wrap">
        <div class="row align-items-center g-4">

            <!-- LEFT POSTER -->
            <div class="col-md-4 text-center">
                {% if need.image %}
                    <img src="{{ need.image.url }}" class="hero-poster">
                {% endif %}
            </div>

            <!-- RIGHT CONTENT -->
            <div class="col-md-8">
                <h2 class="fw-bold mb-3">{{ need.title }}</h2>

                <div class="hero-points">
                    <p>üìç Location ‚Äì {{ need.location }}</p>
                    <p>üè∑ Category ‚Äì {{ need.category }}</p>
                    <p>‚ö° Urgency ‚Äì {{ need.urgency }}</p>
                </div>

                <div class="mt-3">
                    <span class="status-badge">
                        {{ need.status }}
                    </span>
                </div>

                {% if user.is_authenticated %}
                <div class="mt-4 d-flex gap-2 flex-wrap">

                    {% if need.status == "Open" %}
                    <form method="post" action="{% url 'accept_need' need.id %}">
                        {% csrf_token %}
                        <button class="btn btn-success px-4">
                            Accept & Help
                        </button>
                    </form>
                    {% endif %}

                    {% if need.status == "In Progress" and need.assignment.helper == user %}
                    <form method="post" action="{% url 'cancel_need' need.id %}">
                        {% csrf_token %}
                        <button class="btn btn-outline-light px-4">
                            Cancel
                        </button>
                    </form>

                    <form method="post" action="{% url 'complete_need' need.id %}">
                        {% csrf_token %}
                        <button class="btn btn-light text-dark px-4">
                            Mark Completed
                        </button>
                    </form>
                    {% endif %}

                </div>
                {% endif %}

            </div>
        </div>
    </div>

    <!-- DESCRIPTION SECTION -->
    <div class="desc-box mt-5">
        <h4 class="fw-bold mb-3">Description</h4>
        <p class="text-muted">
            {{ need.description }}
        </p>

        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-success mt-3">
                    {{ message|safe }}
                </div>
            {% endfor %}
        {% endif %}
    </div>

</section>
{% endblock body %}
